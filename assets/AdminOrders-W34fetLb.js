import{a as u}from"./axios-Bo0ATomq.js";import{_ as v,M as O,o as d,c,a as t,t as a,i as M,m as w,F as b,f as k,r as f,b as g}from"./index-Dib2dAOW.js";import{P as x}from"./PaginationArea-0oHxBXi7.js";const $={data(){return{tempOrderData:{},orderModal:null}},mounted(){this.orderModal=new O(this.$refs.orderModal,{keyboard:!1,backdrop:"static"})},methods:{openModal(o){this.tempOrderData={...o},console.log(o),this.orderModal.show(),console.log(333)},formatDate(o){const s=new Date(o*1e3),l=s.getFullYear(),_=("0"+(s.getMonth()+1)).slice(-2),e=("0"+s.getDate()).slice(-2);return`${l}-${_}-${e}`}}},C={class:"modal fade",id:"orderModal",tabindex:"-1","aria-labelledby":"exampleModalLabel","aria-hidden":"true",ref:"orderModal"},E={class:"modal-dialog modal-xl modal-dialog-centered"},P={class:"modal-content"},A=t("div",{class:"modal-header"},[t("h5",{class:"modal-title",id:"exampleModalLabel"},"產品詳情"),t("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"})],-1),V={class:"modal-body"},T={class:"row border-bottom mb-3"},I={class:"col-6"},B=t("h5",{class:"mb-3 fw-bold"},"訂購人資訊",-1),F={class:"mb-3"},L=t("p",{class:"mb-1"},"訂購人",-1),S={class:"mb-1"},U={class:"mb-3"},R=t("p",{class:"mb-1"},"訂購信箱",-1),H={class:"mb-1"},N={class:"mb-3"},Y=t("p",{class:"mb-1"},"訂購電話",-1),j={class:"mb-1"},q={class:""},z=t("p",{class:"mb-1"},"訂購地址",-1),G={class:"mb-1"},J={class:"col-6"},K=t("h5",{class:"mb-3 fw-bold"},"訂單資訊",-1),Q={class:"mb-3"},W=t("p",{class:"mb-1"},"訂單編號",-1),X={class:"mb-1"},Z={class:"mb-3"},tt=t("p",{class:"mb-1"},"訂單時間",-1),et={class:"mb-1"},st={class:"mb-3"},ot=t("p",{class:"mb-1"},"訂單金額",-1),at={class:"mb-1"},nt={class:"mb-3"},lt=t("p",{class:"mb-1"},"訂單付款狀態",-1),dt={class:"form-check"},ct={key:0,class:"form-check-label text-success",for:"flexCheckDefault"},it={key:1,class:"form-check-label",for:"flexCheckDefault"},rt=t("h5",null,"訂單內容",-1),_t={class:"table"},mt=t("thead",null,[t("tr",null,[t("th",{scope:"col"},"編號"),t("th",{scope:"col"},"產品名稱"),t("th",{scope:"col"},"數量"),t("th",{scope:"col"},"金額")])],-1),ht={class:"modal-footer"},pt=t("button",{type:"button",class:"btn btn-secondary","data-bs-dismiss":"modal"},"關閉",-1);function ut(o,s,l,_,e,i){var m,h,n,p;return d(),c("div",C,[t("div",E,[t("div",P,[A,t("div",V,[t("div",T,[t("div",I,[B,t("div",F,[L,t("p",S,a((m=e.tempOrderData.user)==null?void 0:m.name),1)]),t("div",U,[R,t("p",H,a((h=e.tempOrderData.user)==null?void 0:h.email),1)]),t("div",N,[Y,t("p",j,a((n=e.tempOrderData.user)==null?void 0:n.tel),1)]),t("div",q,[z,t("p",G,a((p=e.tempOrderData.user)==null?void 0:p.address),1)])]),t("div",J,[K,t("div",Q,[W,t("p",X,a(e.tempOrderData.id),1)]),t("div",Z,[tt,t("p",et,a(i.formatDate(e.tempOrderData.create_at)),1)]),t("div",st,[ot,t("p",at,a(e.tempOrderData.total),1)]),t("div",nt,[lt,t("div",dt,[M(t("input",{class:"form-check-input",type:"checkbox",value:"",id:"flexCheckDefault","onUpdate:modelValue":s[0]||(s[0]=r=>e.tempOrderData.is_paid=r)},null,512),[[w,e.tempOrderData.is_paid]]),e.tempOrderData.is_paid?(d(),c("label",ct," 已付款 ")):(d(),c("label",it," 未付款 "))])])])]),rt,t("table",_t,[mt,t("tbody",null,[(d(!0),c(b,null,k(e.tempOrderData.products,(r,y)=>(d(),c("tr",{key:r.id},[t("td",null,a(y),1),t("td",null,a(r.product.title),1),t("td",null,a(r.qty),1),t("td",null,a(r.total),1)]))),128))])])]),t("div",ht,[pt,t("button",{type:"button",class:"btn btn-outline-danger",onClick:s[1]||(s[1]=r=>o.delOrder(e.tempOrderData.id))},"刪除"),t("button",{type:"button",class:"btn btn-primary",onClick:s[2]||(s[2]=r=>o.changePaid(e.tempOrderData.id))},"修改")])])])],512)}const bt=v($,[["render",ut]]);var ft={VITE_API:"https://vue3-course-api.hexschool.io/v2/",VITE_PATH:"ting-hexschool",BASE_URL:"/week6_vite/",MODE:"production",DEV:!1,PROD:!0,SSR:!1};const{VITE_API:D,VITE_PATH:gt}=ft,Dt={components:{orderModal:bt,Pagination:x},mounted(){const o=document.cookie.replace(/(?:(?:^|.*;\s*)hexToken\s*=\s*([^;]*).*$)|^.*$/,"$1");u.defaults.headers.common.Authorization=o,this.checkAdmin(),this.getData()},data(){return{tempOrder:{},ordersData:[],pagination:{}}},methods:{checkAdmin(){const o=`${D}/api/user/check`;u.post(o).then(()=>{this.getData()}).catch(s=>{alert(s.response.data.message),window.location="login.html"})},getData(o=1){const s=`${D}/api/${gt}/admin/orders?page=${o}`;u.get(s).then(l=>{console.log(l.data);const{orders:_,pagination:e}=l.data;this.ordersData=_,this.pagination=e}).catch(l=>{alert(l.response.data.message)})},openModal(o){this.$refs.editOrderModal.openModal(o)},formatDate(o){const s=new Date(o*1e3),l=s.getFullYear(),_=("0"+(s.getMonth()+1)).slice(-2),e=("0"+s.getDate()).slice(-2);return`${l}-${_}-${e}`}}},vt=t("div",null," 後臺訂單列表 ",-1),kt={class:"container"},yt={class:"table mt-4"},Ot=t("thead",null,[t("tr",null,[t("th",{width:"120"}," 訂單編號 "),t("th",{width:"90"},"購買人"),t("th",{width:"90"}," email "),t("th",{width:"90"}," 購買日期 "),t("th",{width:"90"}," 訂單金額 "),t("th",{width:"90"}," 訂單狀態 "),t("th",{width:"120"}," 編輯 ")])],-1),Mt={key:0,class:"text-success"},wt={key:1},xt={class:"d-grid gap-2 d-md-flex justify-content-md-end"},$t=["onClick"],Ct=t("button",{type:"button",class:"btn btn-outline-danger btn-sm"}," 刪除 ",-1);function Et(o,s,l,_,e,i){const m=f("order-modal"),h=f("pagination");return d(),c(b,null,[vt,t("div",kt,[t("table",yt,[Ot,t("tbody",null,[(d(!0),c(b,null,k(e.ordersData,n=>(d(),c("tr",{key:n.id},[t("td",null,a(n.id),1),t("td",null,a(n.user.name),1),t("td",null,a(n.user.email),1),t("td",null,a(i.formatDate(n.create_at)),1),t("td",null,a(n.total),1),t("td",null,[n.is_paid?(d(),c("span",Mt,"已付款")):(d(),c("span",wt,"未付款"))]),t("td",null,[t("div",xt,[t("button",{type:"button",class:"btn btn-outline-primary btn-sm",onClick:p=>i.openModal(n)}," 詳情 ",8,$t),Ct])])]))),128))])]),g(m,{ref:"editOrderModal","temp-order":e.tempOrder,onUpdate:i.getData},null,8,["temp-order","onUpdate"]),g(h,{pagination:e.pagination,onEmitPages:i.getData},null,8,["pagination","onEmitPages"])])],64)}const Tt=v(Dt,[["render",Et]]);export{Tt as default};
