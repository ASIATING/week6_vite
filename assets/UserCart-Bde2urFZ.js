import{a as p}from"./axios-Bo0ATomq.js";import{S as d}from"./sweetalert2.all-Bv4Tm-lA.js";import{_ as I,r as u,o as i,c as r,a as t,d as c,w as b,F as B,j as $,i as m,t as h,k as P,b as C,l as U,v as S,p as V,e as E}from"./index-DaV_B7mf.js";const q={data(){return{cartEmpty:!1,apiUrl:"https://vue3-course-api.hexschool.io/v2",apiPath:"ting-hexschool",isLoading:!0,products:[],cart:{},qty:1,tempProduct:{},productModal:null,loadingItem:"",form:{user:{name:"",email:"",tel:"",address:""},message:""}}},mounted(){this.getCart()},methods:{getCart(){const e=`${this.apiUrl}/api/${this.apiPath}/cart`;p.get(e).then(s=>{console.log(s),this.cart=s.data.data,this.cart.total===0?this.cartEmpty=!0:this.cartEmpty=!1}).catch(s=>{alert(s.response.data.message)})},addToCart(e,s=1){this.loadingItem=e;const a=`${this.apiUrl}/api/${this.apiPath}/cart`;p.post(a,{data:{product_id:e,qty:s}}).then(_=>{this.loadingItem="",alert(_.data.message),this.$refs.userProductModal.hideModal(),this.getCart()}).catch(_=>{alert(_.response.data.message)})},updateCart(e){this.loadingItem=e.id;const s=`${this.apiUrl}/api/${this.apiPath}/cart/${e.id}`;p.put(s,{data:{product_id:e.product_id,qty:e.qty}}).then(a=>{this.loadingItem="",d.fire({position:"top-end",icon:"success",title:`${a.data.message}`,showConfirmButton:!1,toast:!0,timer:1500}),this.getCart()}).catch(a=>{this.loadingItem="",d.fire({position:"top-end",icon:"error",title:`${a.response.data.message}`,showConfirmButton:!1,toast:!0,timer:1500})})},removeCartItem(e){const s=`${this.apiUrl}/api/${this.apiPath}/cart/${e}`;this.loadingItem=e,p.delete(s).then(a=>{this.loadingItem="",d.fire({position:"top-end",icon:"success",title:`${a.data.message}`,showConfirmButton:!1,toast:!0,timer:1500}),this.getCart()}).catch(a=>{d.fire({position:"top-end",icon:"error",title:`${a.response.data.message}`,showConfirmButton:!1,toast:!0,timer:1500})})},clearCart(){d.fire({title:"確定要清空購物車嗎?",text:" 清空後無法復原! ",icon:"warning",showCancelButton:!0,confirmButtonColor:"#3085d6",cancelButtonColor:"#d33",confirmButtonText:"確定，我要清空購物車!",cancelButtonText:"取消"}).then(e=>{if(e.isConfirmed){const s=`${this.apiUrl}/api/${this.apiPath}/carts`;p.delete(s).then(a=>{d.fire({title:"刪除成功!",text:a.data.message,icon:"success"}).then(()=>{this.getCart()})}).catch(a=>{d.fire({title:"Error!",text:a.response.data.message,icon:"error"})})}})}}},l=e=>(V("data-v-3a18512b"),e=e(),E(),e),N={class:"pageColor pt-3"},T={class:"container"},L={key:0,class:"text-center"},M=l(()=>t("h1",{class:"text-secondary fw-bold"},"目前購屋車沒有東西哦來去購物",-1)),D=l(()=>t("img",{src:"https://cdn.discordapp.com/attachments/1216979871138320384/1217762666949378191/british-cat-with-shopping-cart-isolated-white-kitten-osolated_767502-1923.png?ex=660534dc&is=65f2bfdc&hm=729fdad49f07f58dbee1c1fd573e4803c73e520b71269c2712755819cf52e07f&",class:"m-auto d-block",alt:""},null,-1)),F={key:1},R=l(()=>t("h3",{class:"fw-bold"},"購物車",-1)),j={class:"text-end"},z={class:"table align-middle mt-3"},A=l(()=>t("thead",null,[t("tr",null,[t("th",null,"品名"),t("th",{style:{width:"150px"}},"數量/單位"),t("th",null,"單價"),t("th")])],-1)),G={class:"d-flex align-items-center"},H={class:"d-none d-md-block"},J=["src"],K={key:0,class:"text-success"},O={class:"input-group input-group-sm"},Q=["onUpdate:modelValue","onBlur"],W={class:"input-group-text",id:"basic-addon2"},X={class:"text-end"},Y={key:0,class:"text-success"},Z={class:"text-center"},tt=["onClick"],et={key:0,class:"spinner-border spinner-border-sm",role:"status","aria-hidden":"true"},st={key:1},at=l(()=>t("td",{colspan:"3",class:"text-end"},"總計",-1)),ot={class:"text-center"},nt={key:0},it=l(()=>t("td",{colspan:"3",class:"text-end text-success"},"折扣價",-1)),rt={class:"text-end text-success"},ct={class:"text-end"},lt=l(()=>t("button",{class:"btn btn-primary"},"結帳去",-1)),dt=P('<div class="" data-v-3a18512b><h3 data-v-3a18512b>購物車消費注意事項</h3><ul data-v-3a18512b><li data-v-3a18512b><strong data-v-3a18512b>付款方式：</strong>我們接受所有主要信用卡和 PayPal 作為付款方式。訂單處理前需要付款。</li><li data-v-3a18512b><strong data-v-3a18512b>運輸方式：</strong>我們提供標準和加急運輸選項。運輸費用和交貨時間可能因您的位置和選擇的運輸方式而異。</li><li data-v-3a18512b><strong data-v-3a18512b>退換政策：</strong>如果您對購買的商品不完全滿意，您可以在 30 天內退貨或換貨。請注意，退回的商品必須保持原樣和包裝。</li><li data-v-3a18512b><strong data-v-3a18512b>稅費：</strong>我們網站上列出的所有價格均為美元，並且不含稅。適用地點的訂單將加收銷售稅。</li><li data-v-3a18512b><strong data-v-3a18512b>隱私：</strong>我們致力於保護您的隱私。您提供給我們的任何個人信息將僅用於處理您的訂單，並不會與第三方共享。</li></ul></div>',1),pt=l(()=>t("div",null,".",-1));function ut(e,s,a,_,n,v){const g=u("v-stepper-item"),x=u("v-divider"),y=u("v-stepper-header"),k=u("v-stepper"),w=u("RouterLink");return i(),r("div",N,[t("div",T,[n.cartEmpty?(i(),r("div",L,[M,t("button",{class:"btn btn-primary",onClick:s[0]||(s[0]=o=>this.$router.push("/products"))},"點我逛逛"),D])):(i(),r("div",F,[R,c(k,{class:"stepper-transparent"},{default:b(()=>[c(y,null,{default:b(()=>[c(g,{title:"購物車確認",value:"1"}),c(x),c(g,{title:"填寫訂購資料",value:"2"}),c(x),c(g,{title:"確認付款",value:"3"})]),_:1})]),_:1}),t("div",j,[t("button",{class:"btn btn-outline-danger",type:"button",onClick:s[1]||(s[1]=o=>v.clearCart())},"清空購物車")]),t("table",z,[A,t("tbody",null,[n.cart.carts?(i(!0),r(B,{key:0},$(n.cart.carts,o=>(i(),r("tr",{key:o.id},[t("td",null,[t("div",G,[t("div",H,[t("img",{src:o.product.imageUrl,alt:"",width:"180px"},null,8,J)]),t("div",null,[C(h(o.product.title)+" ",1),o.coupon?(i(),r("div",K,"已套用優惠券")):m("",!0)])])]),t("td",null,[t("div",O,[U(t("input",{min:"1",type:"number",class:"form-control","onUpdate:modelValue":f=>o.qty=f,onBlur:f=>v.updateCart(o)},null,40,Q),[[S,o.qty,void 0,{number:!0}]]),t("span",W,h(o.product.unit),1)])]),t("td",X,[n.cart.final_total!==n.cart.total?(i(),r("small",Y,"折扣價：")):m("",!0),C(" "+h(o.final_total),1)]),t("td",Z,[t("button",{type:"button",class:"btn btn-outline-danger btn-sm",onClick:f=>v.removeCartItem(o.id)},[n.loadingItem===o.id?(i(),r("span",et)):(i(),r("div",st,"刪除"))],8,tt)])]))),128)):m("",!0)]),t("tfoot",null,[t("tr",null,[at,t("td",ot,h(n.cart.total),1)]),n.cart.final_total!==n.cart.total?(i(),r("tr",nt,[it,t("td",rt,h(n.cart.final_total),1)])):m("",!0)])]),t("div",ct,[c(w,{to:"/order",class:"nav-link"},{default:b(()=>[lt]),_:1})]),dt]))]),pt])}const vt=I(q,[["render",ut],["__scopeId","data-v-3a18512b"]]);export{vt as default};
